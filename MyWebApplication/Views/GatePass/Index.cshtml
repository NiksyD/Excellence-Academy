@model IEnumerable<MyWebApplication.Models.GatePass>
@{
	ViewData["Title"] = "Gate Pass Management - Excellence Academy";
}

@section Styles {
	<link rel="stylesheet" href="~/css/Shared/management-page.css" asp-append-version="true" />
}

<!-- Header Section - Mac Style -->
<section class="management-header">
	<div class="container">
		<div class="row align-items-center">
			<div class="col-md-8 mb-3 mb-md-0">
				<h1 class="mb-2">
					<i class="fas fa-id-card me-3 header-icon"></i>Gate Pass Management
				</h1>
				<p class="lead mb-0">Manage vehicle gate pass applications and approvals</p>
			</div>
			<div class="col-md-4 text-md-end">
				<a asp-controller="GatePass" asp-action="Create" class="btn btn-primary-action">
					<i class="fas fa-plus me-2"></i>New Gate Pass
				</a>
			</div>
		</div>
	</div>
</section>

<!-- Main Content -->
<div class="container py-5">
	<!-- Statistics Cards - Mac Style -->
	<div class="row mb-5">
		<div class="col-md-3 col-6 mb-3 mb-md-0">
			<div class="stat-card blue fade-in-up" style="animation-delay: 0.1s">
				<div class="stat-icon">
					<i class="fas fa-file-alt"></i>
				</div>
				<h4 class="stat-number">@(Model?.Count() ?? 0)</h4>
				<p class="stat-label">Total Applications</p>
			</div>
		</div>
		<div class="col-md-3 col-6 mb-3 mb-md-0">
			<div class="stat-card amber fade-in-up" style="animation-delay: 0.2s">
				<div class="stat-icon">
					<i class="fas fa-clock"></i>
				</div>
				<h4 class="stat-number">@(Model?.Where(g => g.Status == "Pending").Count() ?? 0)</h4>
				<p class="stat-label">Pending</p>
			</div>
		</div>
		<div class="col-md-3 col-6 mb-3 mb-md-0">
			<div class="stat-card green fade-in-up" style="animation-delay: 0.3s">
				<div class="stat-icon">
					<i class="fas fa-check-circle"></i>
				</div>
				<h4 class="stat-number">@(Model?.Where(g => g.Status == "Approved").Count() ?? 0)</h4>
				<p class="stat-label">Approved</p>
			</div>
		</div>
		<div class="col-md-3 col-6 mb-3 mb-md-0">
			<div class="stat-card red fade-in-up" style="animation-delay: 0.4s">
				<div class="stat-icon">
					<i class="fas fa-times-circle"></i>
				</div>
				<h4 class="stat-number">@(Model?.Where(g => g.Status == "Rejected").Count() ?? 0)</h4>
				<p class="stat-label">Rejected</p>
			</div>
		</div>
	</div>

	<!-- Search and Filter Section - Mac Style -->
	<div class="search-filter-card fade-in-up" style="animation-delay: 0.5s">
		<div class="row align-items-center g-3">
			<div class="col-md-4">
				<div class="input-group search-input-group">
					<span class="input-group-text"><i class="fas fa-search"></i></span>
					<input type="text" class="form-control" placeholder="Search gate passes..." id="searchInput">
				</div>
			</div>
			<div class="col-md-3">
				<select class="form-select filter-select" id="statusFilter">
					<option value="">All Status</option>
					<option value="Pending">Pending</option>
					<option value="Approved">Approved</option>
					<option value="Rejected">Rejected</option>
				</select>
			</div>
			<div class="col-md-3">
				<select class="form-select filter-select" id="departmentFilter">
					<option value="">All Departments</option>
					@if (Model != null)
					{
						@foreach (var dept in Model.Select(g => g.Department).Distinct().Where(d => !string.IsNullOrEmpty(d)))
						{
							<option value="@dept">@dept</option>
						}
					}
				</select>
			</div>
			<div class="col-md-2">
				<button class="btn btn-export w-100" onclick="exportToCSV()">
					<i class="fas fa-download me-2"></i>Export
				</button>
			</div>
		</div>
	</div>

	<!-- Gate Pass Table - Mac Style -->
	<div class="table-card fade-in-up" style="animation-delay: 0.6s">
		<div class="table-card-header">
			<h5><i class="fas fa-table me-2"></i>Gate Pass Applications</h5>
		</div>
		<div class="p-0">
			@if (Model != null && Model.Any())
			{
				<div class="table-responsive">
					<table class="table management-table mb-0" id="gatePassTable">
						<thead>
							<tr>
								<th class="px-4 py-3">
									<i class="fas fa-hashtag me-2"></i>ID
								</th>
								<th class="px-4 py-3">
									<i class="fas fa-user me-2"></i>Applicant
								</th>
								<th class="px-4 py-3">
									<i class="fas fa-building me-2"></i>Department
								</th>
								<th class="px-4 py-3">
									<i class="fas fa-car me-2"></i>Vehicle
								</th>
								<th class="px-4 py-3">
									<i class="fas fa-calendar me-2"></i>Date
								</th>
								<th class="px-4 py-3">
									<i class="fas fa-info-circle me-2"></i>Status
								</th>
								<th class="px-4 py-3 text-center">
									<i class="fas fa-cogs me-2"></i>Actions
								</th>
							</tr>
						</thead>
						<tbody>
							@foreach (var gatePass in Model)
							{
								<tr>
									<td class="px-4 py-3">
										<span class="badge-id">#@gatePass.Id</span>
									</td>
									<td class="px-4 py-3">
										<div class="fw-medium">@gatePass.Name</div>
										<small class="text-muted">@gatePass.Address</small>
									</td>
									<td class="px-4 py-3">
										<span class="badge-course">@gatePass.Department</span>
										@if (!string.IsNullOrEmpty(gatePass.Faculty))
										{
											<br><small class="text-muted">@gatePass.Faculty</small>
										}
									</td>
									<td class="px-4 py-3">
										<div class="fw-medium">@gatePass.VehiclePlateNo</div>
										<small class="text-muted">@gatePass.VehicleType</small>
									</td>
									<td class="px-4 py-3">
										<small class="text-muted">
											@gatePass.Date.ToString("MMM dd, yyyy")
										</small>
									</td>
									<td class="px-4 py-3">
										@if (gatePass.Status == "Pending")
										{
											<span class="badge-status pending">Pending</span>
										}
										else if (gatePass.Status == "Approved")
										{
											<span class="badge-status approved">Approved</span>
										}
										else if (gatePass.Status == "Rejected")
										{
											<span class="badge-status rejected">Rejected</span>
										}
									</td>
									<td class="px-4 py-3 text-center">
										<div class="action-btn-group">
											<a asp-action="Details" asp-route-id="@gatePass.Id" 
											   class="action-btn view" 
											   title="View Details">
												<i class="fas fa-eye"></i>
											</a>
											@if (gatePass.Status == "Pending")
											{
												<a asp-action="Edit" asp-route-id="@gatePass.Id" 
												   class="action-btn edit" 
												   title="Edit Application">
													<i class="fas fa-edit"></i>
												</a>
												<a asp-action="Delete" asp-route-id="@gatePass.Id" 
												   class="action-btn delete" 
												   title="Delete Application">
													<i class="fas fa-trash"></i>
												</a>
											}
										</div>
									</td>
								</tr>
							}
						</tbody>
					</table>
				</div>
			}
			else
			{
				<div class="empty-state">
					<i class="fas fa-id-card fa-4x empty-state-icon"></i>
					<h4>No Gate Pass Applications Found</h4>
					<p>Start by creating your first gate pass application.</p>
					<a asp-controller="GatePass" asp-action="Create" class="btn btn-primary-action">
						<i class="fas fa-plus me-2"></i>Create First Gate Pass
					</a>
				</div>
			}
		</div>
	</div>
</div>

@section Scripts {
	<script src="~/js/GatePass/index.js"></script>
}